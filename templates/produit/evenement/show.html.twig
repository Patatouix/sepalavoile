{% extends 'base.html.twig' %}

{% block title %}Produit{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('disponibilite') }}
{% endblock %}

{% block body %}

    {{ include('produit/evenement/_modal_disponibilite.html.twig', {'button_label': 'Update'}) }}

    <h1>Produit</h1>

    <table class="table">
        <tbody>
            <tr>
                <th>Id</th>
                <td>{{ produit.id }}</td>
            </tr>
            <tr>
                <th>Nom</th>
                <td>{{ produit.nom }}</td>
            </tr>
            <tr>
                <th>Description</th>
                <td>{{ produit.description }}</td>
            </tr>
            <tr>
                <th>DebutPublication</th>
                <td>{{ produit.debutPublication ? produit.debutPublication|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                <th>FinPublication</th>
                <td>{{ produit.finPublication ? produit.finPublication|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                <th>Adresse</th>
                <td>{{ produit.adresse }}</td>
            </tr>
            <tr>
                <th>CodePostal</th>
                <td>{{ produit.codePostal }}</td>
            </tr>
            <tr>
                <th>Ville</th>
                <td>{{ produit.ville }}</td>
            </tr>
            <tr>
                <th>Prix</th>
                <td>{{ produit.prix }}</td>
            </tr>
            <tr>
                <th>Objectif</th>
                <td>{{ produit.objectif }}</td>
            </tr>
            <tr>
                <th>Duree</th>
                <td>{{ produit.duree }}</td>
            </tr>
            <tr>
                <th>CreatedAt</th>
                <td>{{ produit.createdAt ? produit.createdAt|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                <th>UpdatedAt</th>
                <td>{{ produit.updatedAt ? produit.updatedAt|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
        </tbody>
    </table>

    <a href="{{ path('produit_index') }}">back to list</a>

    <a href="{{ path('produit_edit', {'id': produit.id}) }}">edit</a>

    <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#modal_disponibilite">
        Voir dispos
    </button>

    <a href="{{ path('produit_reservation', {'id': produit.id}) }}">Réserver</a>

    {{ include('produit/_delete_form.html.twig') }}
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script>
        //construction du tableau à fournir au calendrier pour afficher les créneaux
        let creneaux = [];
        let creneau = {};
        {% for creneau in produit.creneaux %}
            creneau = {
                start: '{{ creneau.debut|date('Y-m-d H:i:s') }}',
                end: '{{ creneau.debut|date('Y-m-d H:i:s') }}',
                //couleur selon la disponibilité
                color: '{{ creneau.achats|length == produit.objectif ? 'red' : 'green' }}'
            }
            creneaux.push(creneau);
        {% endfor %}
    </script>

    {{ encore_entry_script_tags('disponibilite') }}
{% endblock %}
